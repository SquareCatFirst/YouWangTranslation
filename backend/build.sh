#!/bin/bash

#linux amd64下可用

# ================================
# 获取脚本所在目录
# ================================
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
echo "脚本所在目录: $SCRIPT_DIR"

# ================================
# 指定 Go 源码目录
# ================================
SRC_DIR="$SCRIPT_DIR/cmd/server"
echo "Go 源码目录: $SRC_DIR"

# ================================
# 输出可执行文件到脚本所在目录
# ================================
OUTPUT="$SCRIPT_DIR/server_linux_amd64"
echo "输出路径: $OUTPUT"

# ================================
# 设置目标系统和架构
# ================================
export GOOS=linux
export GOARCH=amd64

# ================================
# 构建可执行文件
# ================================
go build -o "$OUTPUT" "$SRC_DIR"
BUILD_STATUS=$?

# ================================
# 检查构建结果
# ================================
if [ $BUILD_STATUS -ne 0 ]; then
    echo "构建失败！"
    exit 1
fi

echo "构建成功: $OUTPUT"


